---
title: "The Impact of Formula 1 Tire Compounds"
subtitle: "An Analysis of F1 Tire Compound Impact at the 2024 Hungarian Grand Prix"
author: "Kathryn Sujai, Ellie Wallace, Elisabeth Hadzic"
date: "December 15, 2025"
format:
  pdf:
    geometry: "margin=1in"
    toc: false
    fig-cap-location: top
    tbl-cap-location: top
execute:
  echo: false
  warning: false
  error: false
editor: visual
---

```{r setup, echo=FALSE, message=FALSE, warning=FALSE}
source("Data/DataFiles.R")
```

# Introduction and Race Context

Tire compound selection plays a crucial role in Formula 1 race strategy, directly affecting lap time, tire degradation, and overall race performance. However, the effectiveness of each compound can vary significantly depending on track characteristics and race conditions.

This analysis investigates which tire compound performed best at the 2024 Hungarian Grand Prix. Using lap time and stint data, we examine how tire performance changes with tire age, lap time, and compound by comparing lap times achieved by each driver on different compounds.

The results show that the medium compound consistently outperformed the soft and hard compounds at this race, while the soft compound performed poorly overall.

To understand tire performance at the Hungarian Grand Prix, we first examine how lap times evolve as tires age. We then compare each driverâ€™s fastest laps across compounds and finally discuss strategic insights for optimizing tire choice during the race.

# Tire Performance Overview

## How Tire Age Affects Lap Time

Tire age strongly influences lap time, as tires degrade and lose grip over more laps completed. Examining this relationship helps identify which compound maintains optimal performance and for how long.

```{r}
#| label: fig-LapTime_TireAge
#| fig-cap: "Average Lap Time vs. Tire Age By Compound Line Chart"
#| fig-pos: "H"
#| fig-alt: "A line chart showing the average lap time for each compound based on its tire age. The three compounds are soft, medium, and hard, each represented by a different line. The tire age (x) ranges from 0 to 40 laps. The lap time (y) ranges from 84 to 87 seconds. The lines show that soft tires last about 10 laps, medium about 30, and hard about 40. The lap time increases for each compound after 10 laps. Soft compound is the slowest."

# Lap Time vs. Tire Age Visualization
# Author: Elisabeth Hadzic

# 1: Load needed packages
library(tidyverse)
library(ggplot2)

# 2:Create the line plot
laps_stints_data %>%
  group_by(driver_number, stint_number) %>% # group by driver and stint
  arrange(lap_number) %>%
  mutate(
    stint_lap = row_number() - 1, # resets the stint lap number to 1 for each new stint
  ) %>%
  ggplot(aes(x=stint_lap, y=lap_duration, color = compound, linetype = compound)) + # map the aesthetics
  geom_smooth(se = FALSE) + # smooths the line
  theme_minimal() +
  labs( # Adds labels to the plot
    title = "Average Lap Time vs. Tire Age by Tire Compound",
    x = "Tire Age",
    y = "Lap Time",
    color = "Compound"
  )
```

@fig-LapTime_TireAge displays the relationship between average lap time and tire age for each tire compound (soft, medium, hard). Tire age is measured as the number of laps completed on a specific set of tires. The values were calculated by averaging lap times at each tire age across all stints using that compound. The figure illustrates distinct length patterns for each compound. Soft tires last about 10 laps, medium about 30 laps, and hard up to 40 laps. Lower points on the line represent faster lap times, while spikes and upward trends represent slower times and drop in tire performance. Softer tires are expected to be the fastest compound, however, at this race, it was the slowest on average. Medium tires performed the best overall, reaching its peak at 10 laps. Hard tires were moderate, remaining consistent between soft and medium. Overall, we learn that at the Hungarian Grand Prix, the soft compound was relatively ineffective, making it a less desirable option for race performance. In contrast, the medium compound provided the best balance of speed and durability, emerging as the optimal tire choice for this race.

While @fig-LapTime_TireAge shows general trends by compound, the next section explores individual driver performance to see how these trends relate to fastest laps on each tire.

## Comparing Drivers' Fastest Laps by Compound

Different drivers may show different performance from the same tire compound due to driving style and stint strategy. Comparing their fastest laps highlights both individual differences and the overall effectiveness of each compound.

```{r}
#| label: tbl-FastestLapCompound
#| tbl-cap: "Fastest Lap on Each Compound"
#| tbl-pos: "H"
#| html-table-processing: none
#| lst-label: lst-table1
#| lst-cap: "Code Chunk for Making Table"
#| 
# Driver's fastest lap per compound table
# Author: Elisabeth Hadzic

# 1: Load needed packages
library(tidyverse)
library(kableExtra)
library(knitr)

# 2: Filter for medium tires and find fastest laps
compound_fastest <- laps_stints_data %>%
  filter(compound %in% c("SOFT", "MEDIUM", "HARD")) %>%  # filter 3 compounds
  mutate(compound = factor(compound, levels = c("SOFT", "MEDIUM", "HARD"))) %>% # to stay in order
  group_by(driver, compound) %>% # group by driver and compound
  summarise(
    fastest_lap = min(lap_duration, na.rm = TRUE), # take min lap time for fastest
  ) %>%
  pivot_wider(
    names_from = compound,
    values_from = fastest_lap
  )

# 3: Create the table with kableExtra
compound_fastest %>%
  kable(
    caption = "Driver's Fastest Lap on each Compound", # add title
    col.names = c("Driver", "Soft", "Medium", "Hard"), # apply column names
    align = c("l", "c", "c", "c"),
    booktabs = TRUE,
  ) %>%
  kableExtra::kable_classic(
    font_size = 15,
    lightable_options = "striped" # style type
  )
```

@tbl-FastestLapCompound displays the fastest lap for each driver on each compound they competed with. All drivers completed at least one stint on the medium compound, and the majority also used the hard compound. Furthermore, only 6 drivers recorded laps on the soft compound. Across nearly all drivers, the medium compound produced the fastest lap times compared to the other compounds. For drivers who used multiple compounds, their quickest lap was typically set on medium tires.The soft compound generally resulted in slower fastest lap times when compared to medium and even hard tires. This further supports the earlier findings as seen in @fig-LapTime_TireAge, that the soft compound underperformed at the 2024 Hungarian Grand Prix, despite its reputation as the fastest tire. Overall, the table strengthens the conclusion that the medium compound was the most effective tire choice for achieving peak lap performance, while the soft compound was the least competitive option in this race.

## Drivers with the Fastest Lap's Compounds Over Time

Drivers use different tire compounds in a race to get the fastest lap. Softest tires are usually known to get the fastest speeds, but don't last as long as a hard tire compound. This can vary from race to race, as tracks and weather can impact lap times as well.

```{r}
#| label: fig-FastestLapCompound
#| fig-cap: "Lap Time vs Lap Number by Compound of Top 5 Fastest Drivers"
#| fig-pos: "H"
#| fig-alt: "Five line graphs showing lap times for Perez, Russell, Sainz, Sargeant, and Verstappen with thier tire compounds used being shown by color an linetype. The tire compounds are hard, medium, and soft and a change in tires can be seen by a break in the line. Lap number (x) ranges from 0 to 70 and lap duration (y) ranges from 80 to 90 seconds. Hard tires can be seen as solid blue lines, medium are seen as dashed red lines, and soft can be seen as green lines that have longer dashes."
#| fig-height: 14

# Load Needed Packages
library(ggplot2)
library(dplyr)
library(tidyverse)
library(httr)
library(jsonlite)

# Import the Stint data
response <- GET('https://api.openf1.org/v1/stints?meeting_key=1241') # meeting key 1241 = Hungary 2024
stint_data <- fromJSON(content(response, 'text'))

# Import the Lap data
response1 <- GET('https://api.openf1.org/v1/laps?meeting_key=1241')
laps_data <- fromJSON(content(response1, 'text'))

# Import Driver Data
response3 <- GET('https://api.openf1.org/v1/drivers?meeting_key=1241&session_key=9566')
drivers_data <- fromJSON(content(response3, 'text'))


# Clean the Stint Data
stint_data_clean <- stint_data %>%
  filter(
    session_key == 9566 # filter for the race session only
  ) %>%
  select( # Select needed columns
    stint_number,
    driver_number,
    lap_start,
    lap_end,
    compound,
    tyre_age_at_start
  ) %>%
  mutate(
    stint_length = (lap_end + 1) - lap_start # create a stint_length column
  )

# Clean the Laps Data
laps_data_clean <- laps_data %>%
  filter(
    session_key == 9566, # filter for the race session only
    lap_number != 1, # remove lap 1 due to incomplete data 
    is_pit_out_lap == FALSE # remove outlaps to prevent outliers
  ) %>%
  select( # Select needed columns
    driver_number,
    lap_number,
    lap_duration
  )

# Clean the Driver Data
driver_data_clean <- drivers_data %>%
  select( # Select needed columns
    driver_number,
    team_name,
    first_name,
    last_name
  )

# Join the data
laps_stints_data_clean <- laps_data_clean %>%
  left_join(stint_data_clean, by = "driver_number", relationship = "many-to-many") %>%
  left_join(driver_data_clean, by = "driver_number") %>% # join on driver number
  filter(lap_number >= lap_start & lap_number <= lap_end) # assign lap time to correct stint

# Edit data to make specific to fastest drivers
fastest_lap <- laps_stints_data_clean %>%
  filter(last_name %in% c("Russell", "Sargeant", "Verstappen", "Perez", "Sainz")) 

# Create the data visualization
fastest_lap %>%
  ggplot( #select data
    mapping = aes( #assign variables
      x = lap_number,
      y = lap_duration,
      color = compound,
      linetype = compound,
      group = stint_number
    )
  ) +
  geom_path() + #create line plot
  labs( #add labels
    title = "Duration of Lap Overtime of the Race",
    x = "Lap Number",
    y = "Lap Time (seconds)"
  ) +
  facet_wrap(vars(last_name), ncol = 1) + #create one vertical panel per driver
  scale_color_manual(values = c("HARD" = "blue", "MEDIUM" = "red", "SOFT" = "green")) + #set colors
  theme_bw()
```

@fig-FastestLapCompound displays the 5 different drivers who had the 5 fastest laps in the Hungarian Grand Prix of 2024. Peaks in lines show a slower lap, while dips show a faster lap. All tire compounds were used in this sample, with soft tires being used the least overall. Among these 5 drivers, there is more variation in lap time, stints, stint number, and tire compound. The fastest lap time came from using soft tires, which happened right after Sargeant pitted for the third time in this race and switched. This is not a pattern followed by the other drivers. Overall, you can see that medium and soft achieved a faster lap, but the last third of the race was the fasted overall. An interesting thing to note about this graph is the fact that Sargeant went from having the slowest lap time, with hard compound tires, to the fastest lap time, with soft compound tires. Medium tires still showed the best performance, as supported by @fig-LapTime_TireAge, as those lines are overall lower than than the hard compound. It can also be seen that at the end of the race, when drivers are looking to get a faster lap, most drivers change to medium or soft. This was successful for Sargeant, as he achieved the fasted lap at the end of the race.

## Comparing Distribution of Lap Times 

Of all drivers who had the top fastest lap times recorded, there is great variation in lap number and what compound was used. Showing the distribution of lap time for each driver on each compound highlights the effectiveness of each tire and how variable each compound is.

```{r}
#| label: tbl-FastestLapCompoundDistribution
#| tbl-cap: "Distribtuion of Drivers wiht the Fastest Lap on Each Compound"
#| tbl-pos: "H"
#| html-table-processing: none
#| lst-label: lst-table1
#| lst-cap: "Code Chunk for Making Table"
#| fig-height: 12
# Load Needed Packages
library(kableExtra)
library(knitr)
library(tidyverse)
library(dplyr)

# Create the new Data Frame for the Table
fastest_lapstat <- fastest_lap %>%
  select( #eliminate unessecary columns 
         -driver_number, 
         -lap_number, 
         -stint_number, 
         -lap_start,
         -lap_end, 
         -tyre_age_at_start, 
         -stint_length, 
         -team_name, 
         -first_name) %>%
  group_by(last_name, compound) %>% #group name and compound variables together
  summarise( #calculate the values for the data
    Min = min(lap_duration, na.rm = TRUE),
    Q1 = quantile(lap_duration, probs = 0.25, na.rm = TRUE),
    Median = median(lap_duration, na.rm = TRUE),
    Q3 = quantile(lap_duration, probs = 0.75, na.rm = TRUE),
    Max = max(lap_duration, na.rm = TRUE),
    Mean = mean(lap_duration, na.rm = TRUE),
    Standard_Deviation = sd(lap_duration, na.rm = TRUE),
    .groups = "drop"
  )
# Create new data set for the table
fastest_lap_table <- fastest_lapstat

# Rename column names to be more proper
names(fastest_lap_table) <- c(
  "Driver Last Name",
  "Compound",
  "Minimum",
  "Quartile 1",
  "Median",
  "Quartile 3",
  "Maximum",
  "Mean",
  "Standard Deviation"
)
# Create the table
fastest_lap_table%>%
  kable(
    caption = "Summary Table for Top 5 Drivers with the Fastest Lap", #add captions
    align = c("l", rep("c", 10)),
    digits = 3 #round to 3 decimals
  ) %>%
  kable_classic(
    font_size = 8, #edit font size
    lightable_options = "striped" #make table easier to read and striped
    )
```

@tbl-FastestLapCompoundDistribution displays various numbers showing the distribution of lap times for each driver and the compounds they used. All drivers used only medium and hard tires, except for Sargeant who used all three types of tire compound. For almost all drivers, the minimum lap time for medium tires was lower then the minimum time for hard tires. The average times for both tire compounds varied from driver to driver, with no specific compound out of the two having a lower lap time. To compare the overall performance of each tire, examine @fig-LapTime_TireAge, which will show the average of each tire compound for all drivers. The fastest lap was achieved by soft tires, with the mean being the lowest recorded. However it must be taken into account that this stint with the soft tires, as seen in @fig-FastestLapCompound, was the shortest recorded, and was the only driver who changed to soft tires, so there is no other driver data in the top 5 fastest lap to compare it to. Overall, it can be seen that medium tires are more effective for sustaining fast laps over longer periods of time in this race.

# Race Strategy Insights and Conclusions

Combining insights from tire age trends and driver lap times, we can conclude implications for race strategy. The data suggest which compounds offered the best balance of speed and durability, and how teams could optimize their tire choices during the race.

**Medium Compound Dominance:** The medium tire compound provided the best overall lap times and consistent performance across stints.

**Soft Compound Underperformance:** Despite expectations, soft tires did not yield the fastest laps due to rapid degradation at the Hungarian track. They led the slowest.

**Hard Compound Consistency:** Hard tires were slower than medium tires but provided longer stints. They are preferred in longer runs.

**Race Strategy Implications:** Optimal race strategy at the Hungarian Grand Prix involved prioritizing medium tires for key performance windows, while using hard tires for longevity and soft tires sparingly.

Overall, the data creates a clear narrative: medium tires were the optimal choice at this race, balancing speed and durability, while the other compounds were either too fragile (soft) or too slow (hard) for maximum performance.

# Author Contribution

-   **Kathryn Sujai:**
-   **Ellie Wallace:**
-   **Elisabeth Hadzic:** Data collection, cleaning, and wrangling. Figure 1 and Table 1 creation.

All authors contributed to creation of work-in-progress presentation and final report.

# Code Appendix

```{r codeAppend, ref.label=knitr::all_labels(), echo=TRUE, eval=FALSE}
```
